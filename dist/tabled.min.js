"use strict";var Selectors;!function(e){e.stacked="tabled--stacked",e.table="tabled__table",e.columnLarge="tabled__column--large",e.columnSmall="tabled__column--small",e.wrapper="tabled__wrapper",e.container="tabled",e.fadeLeft="tabled--fade-left",e.fadeRight="tabled--fade-right",e.navigation="tabled__navigation",e.previous="tabled__previous",e.next="tabled__next",e.caption="tabled__caption"}(Selectors||(Selectors={}));class Tabled{constructor(e){if(e.index||(e.index=Math.floor(1e4*Math.random())),this.checkConditions(e.table)){e.table.classList.add(Selectors.table),this.wrap(e.table);const t=this.getWrapper(e.table);t.setAttribute("id","tabled-n"+e.index),this.adjustColumnsWidth(e),this.addTableControls(e),this.applyFade(e.table),t.addEventListener("scroll",(()=>{this.applyFade(e.table)})),new ResizeObserver((()=>{this.applyFade(e.table)})).observe(t)}else if(e.table.classList.contains(Selectors.stacked)){const t=Array.from(e.table.querySelectorAll("thead th"));Array.from(e.table.querySelectorAll("tbody tr")).forEach((e=>{Array.from(e.querySelectorAll("td, th")).forEach(((e,a)=>{const l=t[a];l&&e.setAttribute("data-label",l.innerText+": ")}))}))}else e.failClass&&e.table.classList.add(e.failClass)}getWrapper(e){return e.parentNode}getContainer(e){return e.parentNode?e.parentNode.parentNode:null}adjustColumnsWidth(e){var t,a;const l=null!==(t=e.characterThresholdLarge)&&void 0!==t?t:50,s=null!==(a=e.characterThresholdSmall)&&void 0!==a?a:8;for(let t of e.table.rows)Array.from(t.cells).forEach((e=>{e.innerText.length>l?e.classList.add(Selectors.columnLarge):e.innerText.length<=s&&e.classList.add(Selectors.columnSmall)}))}wrap(e){const t=document.createElement("div");t.classList.add(Selectors.wrapper),t.setAttribute("tabindex","0"),e.parentNode.insertBefore(t,e),t.appendChild(e);const a=document.createElement("div");a.classList.add(Selectors.container),t.parentNode.insertBefore(a,t),a.appendChild(t)}applyFade(e){const t=this.getWrapper(e),a=t.parentNode,l=a.getElementsByClassName(Selectors.previous)[0],s=a.getElementsByClassName(Selectors.next)[0];t.scrollLeft>1?(a.classList.add(Selectors.fadeLeft),l.removeAttribute("disabled")):(a.classList.remove(Selectors.fadeLeft),l.setAttribute("disabled","disabled"));const r=t.offsetWidth;t.scrollWidth-t.scrollLeft-r<1?(a.classList.remove(Selectors.fadeRight),s.setAttribute("disabled","disabled")):(a.classList.add(Selectors.fadeRight),s.removeAttribute("disabled"))}move(e,t="previous"){var a,l;const s=this.getWrapper(e),r=null!==(l=null===(a=s.parentNode)||void 0===a?void 0:a.getBoundingClientRect().left)&&void 0!==l?l:0,o=e.rows[0].cells.length>1?e.rows[0].cells:e.rows[1].cells;let i=0,d=0;if("next"==t)for(let e=0;e<o.length;e++){let t=o[e].getClientRects()[0].left;if(i=Math.floor(t-r),i>1){d=o[e].offsetLeft;break}}else if("previous"==t)for(let e=o.length-1;e>0;e--){let t=o[e].getClientRects()[0].left;if(i=Math.ceil(t-r),i<0){d=o[e].offsetLeft;break}}s.scrollTo({left:d,top:0,behavior:"smooth"})}addTableControls(e){const t=e.table,a=document.createElement("div");a.classList.add(Selectors.navigation),["previous","next"].forEach((e=>{let l=document.createElement("button");l.classList.add("tabled__"+e),l.setAttribute("aria-label",e+" table column"),l.setAttribute("aria-controls",this.getWrapper(t).getAttribute("id")),l.setAttribute("disabled","disabled"),l.setAttribute("type","button"),l.addEventListener("click",(()=>{this.move(t,e)})),a.appendChild(l)}));const l=this.getContainer(t);l&&l.prepend(a);const s=t.querySelector("caption");if(s){s.classList.add("visually-hidden");const a=document.createElement("div");a.classList.add(Selectors.caption),"bottom"===e.captionSide&&a.classList.add("tabled__caption--bottom"),a.innerHTML=s.innerText,a.setAttribute("aria-hidden","true");const l=this.getContainer(t);l&&("bottom"===e.captionSide?l.appendChild(a):l.prepend(a))}}checkConditions(e){if(e.classList.contains(Selectors.stacked))return!1;if(e.querySelector("table"))return!1;if(!e.querySelector("table > tbody"))return!1;return!document.evaluate("ancestor::table",e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}}